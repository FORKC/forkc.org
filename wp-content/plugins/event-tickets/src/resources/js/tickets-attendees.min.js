var tribe_event_tickets_attendees=tribe_event_tickets_attendees||{};!function(c,s){s.count_columns=function(t){var e=0,n=t.find("td, th");return n.length?(n.each(function(){var t=parseInt(c(this).attr("colspan"),10);e+=1+(t=1<t?t-1:0)}),e):0},s.remove_tickets=function(i){c("#the-list").find("tr").each(function(){var t=c(this),e=t.find(".check-column").find("input").val();if("string"==typeof e){var n=e.match(/^[0-9]+/);n.length&&-1!==i.indexOf(parseInt(n[0],10))&&t.remove()}})},c(document).ready(function(){"undefined"!=typeof AttendeesPointer&&null!==AttendeesPointer&&(options=c.extend(AttendeesPointer.options,{close:function(){c.post(Attendees.ajaxurl,{pointer:AttendeesPointer.pointer_id,action:"dismiss-wp-pointer"})},open:function(t,e){e.pointer.css({top:parseInt(e.pointer.css("top").replace("px",""),10)+5}).find(".wp-pointer-arrow").css({right:"50px",left:"auto"}),e.element.on({click:function(){e.element.pointer("close")}})}}),c(AttendeesPointer.target).pointer(options).pointer("open").pointer("widget"));function a(t){c.isArray(t)||(t=[t]);var e=parseInt(.7*c(window).width());e=800<e?800:e;var n=parseInt(.9*c(window).height());n=800<n?800:n;var i="&ticket_ids="+t.join("|")+"&width="+e+"&height="+n,a=Attendees.move_url.replace("&TB_",i+"&TB_");tb_show(null,a,!1)}var t,e;c("input.print").on("click",function(){c(window).trigger("attendees-report-before-print.tribe-tickets");var t=c("table.wp-list-table.attendees"),e=t.find("thead th:visible").length,n=t.find("th,td");n.css({width:100/(e-2)+"%"}),window.print(),n.css({width:""}),c(window).trigger("attendees-report-after-print.tribe-tickets")}),c(".tribe-attendees-email").on({submit:function(t){c(".tribe-attendees-email").hide(),c(document.getElementById("tribe-loading")).show()}}),c(".tickets_checkin").click(function(t){var e=jQuery(this),n={action:"tribe-ticket-checkin",provider:e.attr("data-provider"),attendee_id:e.attr("data-attendee-id"),nonce:Attendees.checkin_nonce};e.attr("data-event-id")&&(n.event_ID=e.attr("data-event-id")),c.post(Attendees.ajaxurl,n,function(t){t.success&&(e.closest("tr").addClass("tickets_checked"),c("#total_checkedin").text(parseInt(c("#total_checkedin").text())+1))},"json"),t.preventDefault()}),c(".tickets_uncheckin").click(function(t){var e=jQuery(this),n={action:"tribe-ticket-uncheckin",provider:e.attr("data-provider"),attendee_id:e.attr("data-attendee-id"),nonce:Attendees.uncheckin_nonce};e.attr("data-event-id")&&(n.event_ID=e.attr("data-event-id")),c.post(Attendees.ajaxurl,n,function(t){t.success&&(e.closest("tr").removeClass("tickets_checked"),c("#total_checkedin").text(parseInt(c("#total_checkedin").text())-1))},"json"),t.preventDefault()}),c("table.wp-list-table").on("click",".row-actions .move-ticket",function(t){var e=c(this).parents("tr").find('input[name="attendee[]"]').val().match(/^[0-9]+/);return e&&a(e),t.stopPropagation(),!1}),c("#doaction, #doaction2").click(function(t){var e;switch(c(t.currentTarget).attr("id")){case"doaction":e="action";break;case"doaction2":e="action2"}if(void 0!==e&&"move"===c('select[name="'+e+'"]').val()){var n=jQuery('input[name="attendee[]"]:checked');if(n.length){var i=[];n.each(function(){var t=c(this).val().match(/^[0-9]+/);t&&i.push(t.toString())}),a(i)}else alert(Attendees.cannot_move);return t.stopPropagation(),!1}}),t=c(".ticket-history"),(e=c(".hide-ticket-history")).hide(),t.click(function(t){var a=c(this),o=a.siblings(".hide-ticket-history"),r=parseInt(a.data("ticket-id"),10),e=a.data("check");if(r&&e){var n,i=c(document.getElementById("ticket-history-"+r));return i.length?(i.show(),a.hide(),o.show()):(n={action:"get_ticket_history",check:e,ticket_id:r},c.post(Attendees.ajaxurl,n,function(t){if(void 0!==t.data&&"string"==typeof t.data.html){var e=a.parents("tr"),n=s.count_columns(e),i=c('<tr id="ticket-history-'+r+'"> <td colspan="'+n+'">'+t.data.html+"</td></tr>");i.hide().insertAfter(e).slideDown(),a.hide(),o.show()}})),t.stopPropagation(),!1}}),e.click(function(t){var e=c(this),n=e.siblings(".ticket-history"),i=parseInt(n.data("ticket-id"),10);c(document.getElementById("ticket-history-"+i)).hide(),n.show(),e.hide()})})}(jQuery,tribe_event_tickets_attendees);
var tribe_event_tickets_plus=tribe_event_tickets_plus||{};tribe_event_tickets_plus.meta=tribe_event_tickets_plus.meta||{},tribe_event_tickets_plus.meta.event=tribe_event_tickets_plus.meta.event||{},function(t,n,u,o){"use strict";o.init=function(){u(".tribe-list").on("click",".attendee-meta.toggle",function(){u(this).toggleClass("on").siblings(".attendee-meta-row").slideToggle()}),this.$ticket_form=u(".tribe-events-tickets").closest(".cart"),this.$ticket_form.on("change",".quantity input, .quantity select",this.event.quantity_changed).on("keyup",".quantity input",this.event.quantity_changed).on("submit",this.event.handle_submission),this.$ticket_form.find('.quantity input:not([type="hidden"]), .quantity select').each(function(){o.set_quantity(u(this))}),u(".tribe-event-tickets-plus-meta-fields").on("keydown",".tribe-tickets-meta-number input",this.event.limit_number_field_typing)},o.render_fields=function(t,e){var i=u(".tribe-event-tickets-plus-meta").filter('[data-ticket-id="'+t+'"]'),n=i.find(".tribe-event-tickets-plus-meta-fields-tpl"),s=i.find(".tribe-event-tickets-plus-meta-fields"),a=n.html();if(o.has_meta_fields(t)){var r=s.find(".tribe-event-tickets-plus-meta-attendee").length,l=0;if(e<r)return l=r-e,void s.find(".tribe-event-tickets-plus-meta-attendee:nth-last-child(-n+"+l+")").remove();l=e-r;for(var c=0;c<l;c++){var d=a;d=(d=a.replace(/tribe-tickets-meta\[\]/g,"tribe-tickets-meta["+t+"]["+(r+c+1)+"]")).replace(/tribe-tickets-meta_([a-z0-9\-]+)_/g,"tribe-tickets-meta_$1_"+(r+c+1)+"_"),s.append(d)}}},o.set_quantity=function(t){var e=parseInt(t.val(),10),i=parseInt(t.closest("td").data("product-id"),10);u(n.getElementById("tribe-event-tickets-plus-meta-fields-tpl-"+i)).html();o.render_fields(i,e)},o.has_meta_fields=function(t){var e=u(n.getElementById("tribe-event-tickets-plus-meta-fields-tpl-"+t)).html();return!!u(e).find(".tribe-tickets-meta").length},o.validate_submission=function(){return!0},o.event.quantity_changed=function(){o.set_quantity(u(this))},o.event.limit_number_field_typing=function(t){-1!==u.inArray(t.keyCode,[46,8,9,27,13,110])||65===t.keyCode&&(!0===t.ctrlKey||!0===t.metaKey)||67===t.keyCode&&!0===t.ctrlKey||86===t.keyCode&&!0===t.ctrlKey||88===t.keyCode&&!0===t.ctrlKey||35<=t.keyCode&&t.keyCode<=40||(t.shiftKey||t.keyCode<48||57<t.keyCode)&&(t.keyCode<96||105<t.keyCode)&&t.preventDefault()},o.event.handle_submission=function(t){if(!o.validate_submission()){t.preventDefault();var e=u(this).closest("form");return e.addClass("tribe-event-tickets-plus-meta-missing-required"),void u("html, body").animate({scrollTop:e.offset().top},300)}},u(function(){o.init()})}(window,document,jQuery,tribe_event_tickets_plus.meta);